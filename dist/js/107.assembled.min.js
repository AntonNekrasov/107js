var h107=function(){"use strict";function e(e,t){if(!e||h107.aliasMap[e])throw"alias "+e+" is either already in use or not specified correctly";h107.aliasMap[e]=function(e){var n=o(t,e),i=s(t.component);return new i(n)}}function t(e,t){var s=function(){this.name=e,Object.getPrototypeOf(this).constructor.superclass.constructor.call(this),t.apply(this)};i(s,h107.BaseController),h107.controllerMap[e]=new s}function s(e){var t=h107.aliasMap[e];if(!t)throw"identifyObjectByAlias: no match found for alias "+e;return h107.aliasMap[e]}function n(e){var t=s(e.component);return new t(e)}function o(e,t){function s(e,t){return r(e)&&r(t)}var n,i={};if(!t)return e;for(n in e)e.hasOwnProperty(n)&&(i[n]=s(t[n],e[n])?o(t[n],e[n]):t[n]?t[n]:e[n]);for(n in t)t.hasOwnProperty(n)&&!e[n]&&(i[n]=t[n]);return i}function i(e,t){var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e,e.superclass=t.prototype}function r(e){return"[object Object]"===Object.prototype.toString.call(e)}function a(e){return"[object Array]"===Object.prototype.toString.call(e)}function c(e,t){var s,n="",o=l(e,t),i="abcdefghijklmnopqrstuvwxyz";for(s=0;o>s;s++)n+=i.charAt(Math.floor(Math.random()*i.length));return n}function l(e,t){return Math.floor(Math.random()*(t-e))+e}return{define:e,controller:t,create:n,identifyObjectByAlias:s,mergeObjects:o,extend:i,generateId:c,isObject:r,isArray:a}}();h107.view={},h107.view.components={},h107.view.components.base={},h107.aliasMap={},h107.controllerMap={},h107.defaults={DURATION:15,ANIMATE_DURATION:30,ID_MAX_LENGTH:10,ID_MIN_LENGTH:5,ACTIVATION_EVENT:"onviewactivate"},h107.Callback=function(e,t,s){"use strict";this.fn=e,this.scope=t,this.parameters=s},h107.History=function(){"use strict";function e(e,t,s){history.pushState(e,t,"#"+s)}function t(e){var t=0===e.indexOf("#");t&&(e=e.substring(1)),setTimeout(function(){for(var t in h107.controllerMap)if(h107.controllerMap.hasOwnProperty(t)){var s=h107.controllerMap[t],n=s.getViewByUrl(e);console.log(n)}},0)}return window.onpopstate=function(e){var t=e.state,s=new Event(h107.defaults.ACTIVATION_EVENT,{url:e.newUrl}),n=h107.controllerMap[t.controller];n.dispatchEvent(s)},{changeRoute:e,navigateToRoute:t}}(),h107.DomProcessor=function(){"use strict";function e(e,s,n){var o,i=document.createElement(e);for(o in s)s.hasOwnProperty(o)&&t(i,o,s[o]);return n&&(i.innerText=n,i.textContent=n),i}function t(e,t,s){if(h107.isObject(s)){var n,o="";for(n in s)s.hasOwnProperty(n)&&(o+=n+":"+s[n]+";");e.setAttribute(t,o)}else e.setAttribute(t,s)}function s(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)}function n(e,t){s(e,t)||(e.className=e.className?[e.className,t].join(" "):t)}function o(e,t){if(s(e,t)){var n=e.className;e.className=n.replace(new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)","g"),"")}}return{buildElement:e,applyAttribute:t,hasClassName:s,addClassName:n,removeClassName:o}}(),h107.view.components.base.BaseElement=function(e){"use strict";var t={attributes:{id:e.id||h107.generateId(h107.defaults.ID_MIN_LENGTH,h107.defaults.ID_MAX_LENGTH)}};this.settings=h107.mergeObjects(t,e),this.html=this.assemble()},h107.view.components.base.BaseElement.prototype={constructor:h107.view.components.base.BaseElement,assemble:function(){"use strict";throw"method hasn't been specified"},hide:function(e){"use strict";h107.DomProcessor.addClassName(this.html,"h107-hidden"),e&&e.fn.apply(e.scope,e.parameters)},show:function(e){"use strict";h107.DomProcessor.removeClassName(this.html,"h107-hidden"),e&&e.fn.apply(e.scope,e.parameters)},fadeOut:function(e,t){"use strict";var s=this,n=s.html,o=setInterval(function(){var e=parseFloat(n.style.opacity);e>0?s.html.style.opacity=e-.1:(clearInterval(o),s.hide(),t&&t.fn.apply(t.scope,t.parameters))},e||h107.defaults.ANIMATE_DURATION)},fadeIn:function(e,t){"use strict";var s,n=this,o=n.html;n.show(),s=setInterval(function(){var e=parseFloat(o.style.opacity);e>=1?(clearInterval(s),t&&t.fn.apply(t.scope,t.parameters)):o.style.opacity=e+.1},e||h107.defaults.ANIMATE_DURATION)}},h107.view.components.base.BaseInput=function(e){"use strict";var t={name:"",label:{attributes:{},text:""},container:{attributes:{}}},s=h107.mergeObjects(t,e);if(!s.name)throw"Input element: name is not defined";h107.view.components.base.BaseInput.superclass.constructor.call(this,s)},h107.extend(h107.view.components.base.BaseInput,h107.view.components.base.BaseElement),h107.view.components.base.BaseInput.prototype.validate=function(){"use strict"},h107.view.components.base.BaseInput.prototype.assemble=function(e){"use strict";if(!e)throw"BaseInput: no input defined";var t=h107.DomProcessor.buildElement,s=this.settings.container,n=t("div",s.attributes),o=this.settings.label;o.attributes["for"]=e.id;var i=t("label",o.attributes,o.text);return n.appendChild(i),n.appendChild(e),n},h107.view.components.base.BaseContainer=function(e){"use strict";var t={attributes:{},components:[]};this.components={};var s=h107.mergeObjects(t,e);h107.view.components.base.BaseContainer.superclass.constructor.call(this,s)},h107.extend(h107.view.components.base.BaseContainer,h107.view.components.base.BaseElement),h107.view.components.base.BaseContainer.prototype.assemble=function(e){"use strict";var t=this,s=t.settings.components;return s.map(function(s){var n=h107.create(s);t.append(e,n)}),e},h107.view.components.base.BaseContainer.prototype.append=function(e,t){"use strict";this.components[t.settings.attributes.id]=t,e.appendChild(t.html)},h107.view.components.base.Controllable=function(e){"use strict";h107.view.components.base.Controllable.superclass.constructor.call(this,e),h107.controllerMap[e.controller].registerView(this)},h107.extend(h107.view.components.base.Controllable,h107.view.components.base.BaseContainer),h107.view.components.base.Controllable.prototype.assemble=function(e){"use strict";return h107.view.components.base.Controllable.superclass.assemble.call(this,e)},h107.view.components.base.Controllable.prototype.getController=function(){"use strict";return h107.controllerMap[this.settings.controller]},h107.view.components.TextInput=function(e){"use strict";var t={attributes:{placeholder:""}},s=h107.mergeObjects(t,e);h107.view.components.TextInput.superclass.constructor.call(this,s)},h107.extend(h107.view.components.TextInput,h107.view.components.base.BaseInput),h107.aliasMap.text=h107.view.components.TextInput,h107.view.components.TextInput.prototype.assemble=function(){"use strict";var e=this.settings.attributes;e.type="text",e.name=this.settings.name;var t=h107.DomProcessor.buildElement("input",e);return h107.view.components.TextInput.superclass.assemble.call(this,t)},h107.view.components.HiddenInput=function(e){"use strict";h107.view.components.HiddenInput.superclass.constructor.call(this,e)},h107.extend(h107.view.components.HiddenInput,h107.view.components.base.BaseInput),h107.aliasMap.hidden=h107.view.components.HiddenInput,h107.view.components.HiddenInput.prototype.assemble=function(){"use strict";var e=this.settings.attributes;e.type="hidden",e.name=this.settings.name;var t=h107.DomProcessor.buildElement("input",e);return t},h107.view.components.Textarea=function(e){"use strict";var t={attributes:{placeholder:"",style:{resize:"vertical"}}},s=h107.mergeObjects(t,e);h107.view.components.Textarea.superclass.constructor.call(this,s)},h107.extend(h107.view.components.Textarea,h107.view.components.base.BaseInput),h107.aliasMap.textarea=h107.view.components.Textarea,h107.view.components.Textarea.prototype.assemble=function(){"use strict";var e=this.settings.attributes;e.name=this.settings.name;var t=h107.DomProcessor.buildElement("textarea",e);return h107.view.components.Textarea.superclass.assemble.call(this,t)},h107.view.components.Table=function(e){"use strict";var t={name:"",attributes:{placeholder:""}},s=h107.mergeObjects(t,e);h107.view.components.Table.superclass.constructor.call(this,s)},h107.extend(h107.view.components.Table,h107.view.components.base.BaseElement),h107.aliasMap.table=h107.view.components.Table,h107.view.components.Table.prototype.assemble=function(){"use strict";var e=h107.DomProcessor.buildElement,t=e("table",this.settings),s=e("thead"),n=e("th"),o=e("td",{},"test");return n.appendChild(o),s.appendChild(n),t.appendChild(s),t},h107.view.components.Button=function(e){"use strict";var t={id:"",text:""},s=h107.mergeObjects(t,e);h107.view.components.Button.superclass.constructor.call(this,s)},h107.extend(h107.view.components.Button,h107.view.components.base.BaseElement),h107.view.components.Section=function(e){"use strict";var t={},s=h107.mergeObjects(t,e);h107.view.components.Section.superclass.constructor.call(this,s)},h107.extend(h107.view.components.Section,h107.view.components.base.BaseContainer),h107.aliasMap.section=h107.view.components.Section,h107.view.components.Section.prototype.assemble=function(){"use strict";var e=this.settings.attributes,t=h107.DomProcessor.buildElement("div",e);return h107.view.components.Section.superclass.assemble.call(this,t)},h107.view.View=function(e){"use strict";var t={"class":"h107-hidden",attributes:{style:{opacity:0}}},s=h107.mergeObjects(t,e);h107.view.View.superclass.constructor.call(this,s)},h107.extend(h107.view.View,h107.view.components.base.Controllable),h107.aliasMap.view=h107.view.View,h107.view.View.prototype.assemble=function(){"use strict";var e=this.settings.attributes,t=h107.DomProcessor.buildElement("div",e);return h107.view.View.superclass.assemble.call(this,t)},h107.view.View.prototype.isActive=function(){"use strict";return!!this.settings.active},h107.view.View.prototype.desActivate=function(e,t){"use strict";this.settings.active=!1,0===e?this.hide(t):this.fadeOut(e,t)},h107.view.View.prototype.activate=function(e,t){"use strict";var s=this.settings;s.active=!0;var n={view:s.id,controller:this.getController().name};h107.History.changeRoute(n,s.name,s.url),0===e?this.show(t):this.fadeIn(e,t)},h107.view.CardView=function(e){"use strict";var t={components:[],attributes:{style:{position:"relative"}}},s=h107.mergeObjects(t,e);h107.view.CardView.superclass.constructor.call(this,s);var n=this.getActiveView();n&&this.setActive(n.settings.id)},h107.extend(h107.view.CardView,h107.view.components.base.Controllable),h107.aliasMap.cardview=h107.view.CardView,h107.view.CardView.prototype.assemble=function(){"use strict";var e=this,t=h107.DomProcessor.buildElement("div",this.settings.attributes),s=e.settings.components;return s.map(function(t){var s=h107.create(t);if(!(s instanceof h107.view.View))throw"CardView can only accept h107.view.View object types";e.append(s)}),t},h107.view.CardView.prototype.append=function(e){"use strict";this.components[e.settings.attributes.id]=e},h107.view.CardView.prototype.getActiveView=function(){"use strict";for(var e in this.components)if(this.components.hasOwnProperty(e)&&this.components[e].isActive())return this.components[e]},h107.view.CardView.prototype.setActive=function(e,t){"use strict";var s=this.getActiveView(),n=this.components[e];this.html.innerHTML="",this.html.appendChild(n.html),s?s.desActivate(t||h107.defaults.DURATION,new h107.Callback(n.activate,n,[t||h107.defaults.DURATION])):n.activate(t||h107.defaults.DURATION)},h107.view.FormView=function(e){"use strict";var t={action:"",method:"POST"},s=h107.mergeObjects(t,e);h107.view.FormView.superclass.constructor.call(this,s)},h107.extend(h107.view.FormView,h107.view.components.base.Controllable),h107.aliasMap.form=h107.view.FormView,h107.view.FormView.prototype.assemble=function(){"use strict";var e=this.settings.attributes;e.action=this.settings.action,e.method=this.settings.method;var t=h107.DomProcessor.buildElement("form",e);return h107.view.FormView.superclass.assemble.call(this,t)},h107.view.FormView.prototype.isDirty=function(){"use strict"},h107.view.FormView.prototype.validate=function(){"use strict"},h107.view.FormView.prototype.submit=function(){"use strict"},h107.view.FormView.prototype.loadRecord=function(e){"use strict";console.log(e)},h107.ajax=function(e){"use strict";var t=this,s={type:"GET",url:"",data:{},dataType:"text",success:null,error:null,always:null,reply:"reply",cached:!0},n=h107.mergeObjects(s,e),o=window.XMLHttpRequest?new XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");o.onreadystatechange=function(){var e,s={},i=200,r=4;o.readyState===r&&o.status===i&&n.success?e=n.success:n.error&&(e=n.error),e&&(s=e.parameters,o.response&&(s[e.reply]=o.response),e.fn.apply(e.scope?e.scope:t,[s])),n.always&&(s=n.always.parameters,o.response&&(s[e.reply]=o.response),n.always.fn.apply(n.always.scope?n.always.scope:t,[s]))},o.open(n.type,n.cached?n.url:n.url+"?_c="+Math.random(),!0),o.responseType=n.type,o.send()},h107.BaseController=function(){"use strict";this.__views=[],this.__subscriptions=[]},h107.BaseController.prototype.registerView=function(e){"use strict";var t=["id","url","controller"];t.map(function(t){if(!e.settings[t])throw t+" field is mandatory for controllable View"}),this.__views.push(e),this.__subscriptions.map(function(t){t(e.html)})},h107.BaseController.prototype.navigate=function(e,t,s){"use strict";var n=this.getView(e);if(!n)for(var o in h107.controllerMap)if(h107.controllerMap.hasOwnProperty(o)&&h107.controllerMap[o]!==this){var i=h107.controllerMap[o].getView(e);i&&(n=i)}n.activate(s||h107.defaults.DURATION,t)},h107.BaseController.prototype.getController=function(e){"use strict";return h107.controllerMap[e]},h107.BaseController.prototype.getView=function(e){"use strict";var t;return this.__views.map(function(s){s.settings.id===e&&(t=s)}),t},h107.BaseController.prototype.addEventListener=function(){"use strict";return document.addEventListener||document.attachEvent},h107.BaseController.prototype.view=function(e){"use strict";var t=this;return{onactive:function(s){t.addEventListener(h107.defaults.ACTIVATION_EVENT,function(){t.__views.filter(function(t){return e?t.settings.id===e:!0}).map(function(e){s.apply(e)})})}}},h107.BaseController.prototype.subscribe=function(e){"use strict";var t=this;return{on:function(s,n){var o=function(t){var o=t.querySelectorAll(e);h107.BaseController.addListener(o,s,n)};t.__subscriptions.push(o)}}},h107.BaseController.addListener=function(e,t,s){"use strict";var n=Array.prototype.forEach;n.call(e,function(e){e.addEventListener(t,function(){s.apply(e)},!1)})},h107.App=function(){"use strict";function e(e){var t=h107.create({component:e});if(!(t instanceof h107.view.CardView))throw"landing view can only be of type h107.view.CardView";document.body.appendChild(t.html)}return{launch:e}}();